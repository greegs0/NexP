<!-- app/views/dashboard/show.html.erb -->

<div class="max-w-7xl mx-auto px-4 py-8">

  <!-- Header du Dashboard -->
  <div class="mb-8">
    <h1 class="text-3xl font-bold text-gray-900">
      üëã Bienvenue, <%= @user.name %>
    </h1>
    <p class="text-gray-600 mt-2">
      Voici un aper√ßu de ton profil
    </p>
  </div>

  <!-- Cards des Stats -->
  <div class="grid grid-cols-1 md:grid-cols-4 gap-6 mb-8">

    <!-- Card Niveau -->
    <div class="bg-white rounded-lg shadow p-6">
      <div class="flex items-center justify-between">
        <div>
          <p class="text-sm text-gray-600">Niveau</p>
          <p class="text-3xl font-bold text-gray-900"><%= @user.level %></p>
        </div>
        <div class="text-4xl">‚≠ê</div>
      </div>
      <p class="text-xs text-gray-500 mt-2"><%= @user.experience_points %> XP</p>
    </div>

    <!-- Card Comp√©tences -->
    <div class="bg-white rounded-lg shadow p-6">
      <div class="flex items-center justify-between">
        <div>
          <p class="text-sm text-gray-600">Comp√©tences</p>
          <p class="text-3xl font-bold text-gray-900"><%= @total_skills %></p>
        </div>
        <div class="text-4xl">‚ö°</div>
      </div>
      <%= link_to "G√©rer", skills_path, class: "text-blue-600 hover:text-blue-800 text-sm mt-4 inline-block" %>
    </div>

    <!-- Card Projets -->
    <div class="bg-white rounded-lg shadow p-6">
      <div class="flex items-center justify-between">
        <div>
          <p class="text-sm text-gray-600">Projets</p>
          <p class="text-3xl font-bold text-gray-900"><%= @total_projects %></p>
        </div>
        <div class="text-4xl">üöÄ</div>
      </div>
      <%= link_to "Voir tout", projects_path, class: "text-blue-600 hover:text-blue-800 text-sm mt-4 inline-block" %>
    </div>

    <!-- Card Projets cr√©√©s -->
    <div class="bg-white rounded-lg shadow p-6">
      <div class="flex items-center justify-between">
        <div>
          <p class="text-sm text-gray-600">Mes cr√©ations</p>
          <p class="text-3xl font-bold text-gray-900"><%= @total_owned_projects %></p>
        </div>
        <div class="text-4xl">üíº</div>
      </div>
      <%= link_to "Nouveau", new_project_path, class: "text-blue-600 hover:text-blue-800 text-sm mt-4 inline-block" %>
    </div>

  </div>

  <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8">

    <!-- Section : Mes comp√©tences r√©centes -->
    <div class="bg-white rounded-lg shadow p-6">
      <div class="flex items-center justify-between mb-4">
        <h2 class="text-xl font-bold text-gray-900">‚ö° Mes comp√©tences</h2>
        <%= link_to "G√©rer", skills_path, class: "text-blue-600 hover:text-blue-800 text-sm" %>
      </div>

      <% if @recent_skills.any? %>
        <div class="flex flex-wrap gap-2">
          <% @recent_skills.each do |skill| %>
            <span class="inline-flex items-center px-3 py-1 rounded-full text-sm bg-blue-100 text-blue-800">
              <%= skill.name %>
            </span>
          <% end %>
          <% if @total_skills > 5 %>
            <span class="inline-flex items-center px-3 py-1 rounded-full text-sm bg-gray-100 text-gray-600">
              +<%= @total_skills - 5 %> autres
            </span>
          <% end %>
        </div>
      <% else %>
        <p class="text-gray-500 text-center py-8">
          Aucune comp√©tence ajout√©e.
          <%= link_to "Ajoute-en !", skills_path, class: "text-blue-600 hover:underline" %>
        </p>
      <% end %>
    </div>

    <!-- Section : Mes projets cr√©√©s -->
    <div class="bg-white rounded-lg shadow p-6">
      <div class="flex items-center justify-between mb-4">
        <h2 class="text-xl font-bold text-gray-900">üíº Mes projets</h2>
        <%= link_to "Cr√©er", new_project_path, class: "text-blue-600 hover:text-blue-800 text-sm" %>
      </div>

      <% if @owned_projects.any? %>
        <div class="space-y-3">
          <% @owned_projects.each do |project| %>
            <div class="border-l-4 border-blue-500 pl-4 py-2">
              <h3 class="font-semibold text-gray-900">
                <%= link_to project.title, project_path(project), class: "hover:text-blue-600" %>
              </h3>
              <p class="text-sm text-gray-600">
                <%= project.current_members_count %>/<%= project.max_members %> membres ¬∑
                <span class="capitalize"><%= project.status %></span>
              </p>
            </div>
          <% end %>
        </div>
      <% else %>
        <p class="text-gray-500 text-center py-8">
          Aucun projet cr√©√©.
          <%= link_to "Cr√©e le premier !", new_project_path, class: "text-blue-600 hover:underline" %>
        </p>
      <% end %>
    </div>

  </div>

  <!-- Section : Projets que j'ai rejoints -->
  <div class="bg-white rounded-lg shadow p-6">
    <div class="flex items-center justify-between mb-4">
      <h2 class="text-xl font-bold text-gray-900">üéØ Projets rejoints</h2>
      <%= link_to "Parcourir", projects_path, class: "bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700" %>
    </div>

    <% if @recent_projects.any? %>
      <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
        <% @recent_projects.each do |project| %>
          <div class="border rounded-lg p-4 hover:shadow-lg transition">
            <h3 class="font-semibold text-gray-900 mb-2">
              <%= link_to project.title, project_path(project), class: "hover:text-blue-600" %>
            </h3>
            <p class="text-sm text-gray-600 mb-2">Par <%= project.owner.display_name %></p>
            <% if project.skills.any? %>
              <div class="flex flex-wrap gap-1 mt-2">
                <% project.skills.limit(3).each do |skill| %>
                  <span class="text-xs px-2 py-1 bg-gray-100 text-gray-700 rounded">
                    <%= skill.name %>
                  </span>
                <% end %>
              </div>
            <% end %>
          </div>
        <% end %>
      </div>
    <% else %>
      <p class="text-gray-500 text-center py-8">
        Tu n'as encore rejoint aucun projet.
        <%= link_to "Parcourir les projets", projects_path, class: "text-blue-600 hover:underline" %>
      </p>
    <% end %>
  </div>

</div>
